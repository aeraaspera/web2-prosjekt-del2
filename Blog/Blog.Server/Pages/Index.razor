@page "/"

<PageTitle>Homepage</PageTitle>

<MudContainer MaxWidth="MaxWidth.Small" Style="@($"padding-top:10%;padding-button:10%;")">

   <div class="d-flex justify-center">
        <MudImage Src="images/floral.jpg" Fluid="true" Elevation="25" Class="rounded-lg ma-4" Style="opacity: 0.4" href="http://www.freepik.com"></MudImage>
        <MudText Typo="Typo.h5" Align="Align.Center" Style="@($"color:#36454F;position:absolute;margin-top:8%;padding:10px;")">
            Hello,
            @if (!string.IsNullOrEmpty(UserName))
            {
                <b Style="@($"color:#ff4da6;")">@UserName</b>
            }
            else
            {
                <b Style="@($"color:#ff4da6;")">Guest</b>
            }
            <br/>Welcome to
            <MudButton Variant="Variant.Outlined" Style="@($"color:white;background-color:#024364;font-size:1.25rem")" href="@($"/blogs")">blogs</MudButton>
        </MudText>
    </div>
    

</MudContainer>


@code {

    [CascadingParameter]
    private Task<AuthenticationState>? AuthStateTask { get; set; }

    private string? UserName { get; set; }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            var state = await GetAuthState();
            if (state?.User?.Identities?.First().Claims.Any() == true)
            {
                UserName = state.User.Identities.First().Claims.ElementAt(2).Value;
                StateHasChanged();
            }
        }
    }

    private async Task<AuthenticationState> GetAuthState()
    {
        var authState = await AuthStateTask;
        return authState;
    }
}







